# HA 구성시 신경 쓸 옵션들 & 조합


- Kafka 설정(server.properties)에서

```
  ########################################################
  # 모든 replications.factor 관련 설정 방법

  # 브로커 수: n
  # replications.factor 권장값: n-1
  # replications.factor 허용값: n과 같거나 작아야 함 && 최소 1
  
  # 이미 생성된 topic의 replication.factor는 여기서 변경불가. kafka-reassign-partitions.sh 스크립트를 사용하여 수동변경 가능.
  # 중요한 topic일 수록 replication.factor가 크면 좋음(e.g. __consumer_offset, connect-offset 등 연결정보 토픽)
  ########################################################
  # __consumer_offset의 복제 수 (default: 3)
  offsets.topic.replication.factor: 3
  # 신규생성 토픽의 파티션 수  (default: 1)
  num.partitions: 3
  # 신규생성 토픽의 복제 수    (default: 1)
  default.replication.factor: 2
  # 신규생성 토픽의 segment(roll) 분할 기간 단위  (default: 7일, 604800000)
  log.roll.ms: 172800000  # 2일
  # 신규생성 토픽에서 Record의 메타데이터 timestamp 타입 (default: CreateTime)
  log.message.timestamp.type: LogAppendTime

```

- 개별 Topic 에서
  - replication.factor=3(RF)
  - min.insync.replicas=2 (minISR)
- Producer에서
  - acks=all
  - acks=1

- 현재 토픽(파티션) 상태
  - ISR (In-Sync Replica)
